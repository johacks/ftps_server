<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FTPS Server: src/ftps_server.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FTPS Server<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Simple FTPS server in C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">ftps_server.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>FTP server implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="utils_8h_source.html">utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="network_8h_source.html">network.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ftp_8h_source.html">ftp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="authenticate_8h_source.html">authenticate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="callbacks_8h_source.html">callbacks.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ftp__session_8h_source.html">ftp_session.h</a>&quot;</code><br />
<code>#include &quot;config_parser.h&quot;</code><br />
<code>#include &quot;<a class="el" href="ftp__files_8h_source.html">ftp_files.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ftps_server.c:</div>
<div class="dyncontent">
<div class="center"><img src="ftps__server_8c__incl.png" border="0" usemap="#asrc_2ftps__server_8c" alt=""/></div>
<map name="asrc_2ftps__server_8c" id="asrc_2ftps__server_8c">
<area shape="rect" title="FTP server implementation." alt="" coords="1107,5,1224,31"/>
<area shape="rect" href="utils_8h.html" title="Miscellaneous macros and functions." alt="" coords="1186,372,1243,397"/>
<area shape="rect" href="network_8h.html" title="Declarations and inclusion of useful libraries for network programming in C in a UNIX environment." alt="" coords="890,299,969,324"/>
<area shape="rect" href="ftp_8h.html" title="Contains information about the ftp protocol." alt="" coords="1278,225,1325,251"/>
<area shape="rect" href="authenticate_8h.html" title="Prototypes of functions related to user authentication." alt="" coords="1400,79,1504,104"/>
<area shape="rect" href="callbacks_8h.html" title="Definition of callbacks associated with ftp commands." alt="" coords="1163,79,1251,104"/>
<area shape="rect" href="config__parser_8h_source.html" title=" " alt="" coords="979,152,1090,177"/>
<area shape="rect" href="ftp__session_8h.html" title="Contains the ftp_session structure and operations associated with it. Keep ftp session information." alt="" coords="1115,152,1213,177"/>
<area shape="rect" href="ftp__files_8h.html" title="Manipulation of file, paths and data connection." alt="" coords="999,225,1076,251"/>
<area shape="rect" title=" " alt="" coords="5,445,69,471"/>
<area shape="rect" title=" " alt="" coords="93,445,155,471"/>
<area shape="rect" title=" " alt="" coords="179,445,245,471"/>
<area shape="rect" title=" " alt="" coords="269,445,328,471"/>
<area shape="rect" title=" " alt="" coords="353,445,418,471"/>
<area shape="rect" title=" " alt="" coords="442,445,507,471"/>
<area shape="rect" title=" " alt="" coords="532,445,604,471"/>
<area shape="rect" title=" " alt="" coords="628,445,695,471"/>
<area shape="rect" title=" " alt="" coords="719,445,788,471"/>
<area shape="rect" title=" " alt="" coords="813,445,881,471"/>
<area shape="rect" title=" " alt="" coords="905,445,972,471"/>
<area shape="rect" title=" " alt="" coords="996,445,1087,471"/>
<area shape="rect" title=" " alt="" coords="1111,445,1206,471"/>
<area shape="rect" title=" " alt="" coords="1230,445,1311,471"/>
<area shape="rect" title=" " alt="" coords="1336,445,1416,471"/>
<area shape="rect" title=" " alt="" coords="1441,445,1535,471"/>
<area shape="rect" title=" " alt="" coords="1559,445,1657,471"/>
<area shape="rect" title=" " alt="" coords="1681,445,1751,471"/>
<area shape="rect" title=" " alt="" coords="1775,445,1833,471"/>
<area shape="rect" title=" " alt="" coords="1857,445,1933,471"/>
<area shape="rect" title=" " alt="" coords="1957,445,2019,471"/>
<area shape="rect" title=" " alt="" coords="2044,445,2121,471"/>
<area shape="rect" title=" " alt="" coords="2145,445,2201,471"/>
<area shape="rect" title=" " alt="" coords="2226,445,2289,471"/>
<area shape="rect" title=" " alt="" coords="2313,445,2364,471"/>
<area shape="rect" title=" " alt="" coords="2389,445,2465,471"/>
<area shape="rect" title=" " alt="" coords="986,372,1083,397"/>
<area shape="rect" title=" " alt="" coords="453,372,555,397"/>
<area shape="rect" title=" " alt="" coords="580,372,647,397"/>
<area shape="rect" title=" " alt="" coords="671,372,753,397"/>
<area shape="rect" title=" " alt="" coords="778,372,873,397"/>
<area shape="rect" title=" " alt="" coords="897,372,962,397"/>
<area shape="rect" title=" " alt="" coords="1107,372,1162,397"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8fb447618db946a9e2a596d9ea18763f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#a8fb447618db946a9e2a596d9ea18763f">_DEFAULT_SOURCE</a></td></tr>
<tr class="separator:a8fb447618db946a9e2a596d9ea18763f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3024ccd4a9af5109d24e6c57565d74a1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#a3024ccd4a9af5109d24e6c57565d74a1">_POSIX_C_SOURCE</a>&#160;&#160;&#160;200112L</td></tr>
<tr class="separator:a3024ccd4a9af5109d24e6c57565d74a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac39f75a2a532f10f6fb237e96c530dcb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#ac39f75a2a532f10f6fb237e96c530dcb">MAX_PASSWORD</a>&#160;&#160;&#160;<a class="el" href="utils_8h.html#ac0cd46269606fb8df1dd1722eb05ecdf">MEDIUM_SZ</a></td></tr>
<tr class="separator:ac39f75a2a532f10f6fb237e96c530dcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d980ebde0fb952e696005b5d58228a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#a1d980ebde0fb952e696005b5d58228a7">USING_AUTHBIND</a>&#160;&#160;&#160;&quot;--using-authbind&quot;</td></tr>
<tr class="separator:a1d980ebde0fb952e696005b5d58228a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e609267dbe6e0905f6b6279386b5c4d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#a1e609267dbe6e0905f6b6279386b5c4d">THREAD_CLOSE_WAIT</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a1e609267dbe6e0905f6b6279386b5c4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89e390b657d2bd9a1b4d102ed78ce239"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#a89e390b657d2bd9a1b4d102ed78ce239">CONTROL_SOCKET_TIMEOUT</a>&#160;&#160;&#160;150</td></tr>
<tr class="separator:a89e390b657d2bd9a1b4d102ed78ce239"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aac0bbb4cddfac921ea84d64f38a280b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#aac0bbb4cddfac921ea84d64f38a280b2">accept_loop</a> (int socket_control_fd)</td></tr>
<tr class="memdesc:aac0bbb4cddfac921ea84d64f38a280b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loop of acceptance of new connections.  <a href="ftps__server_8c.html#aac0bbb4cddfac921ea84d64f38a280b2">More...</a><br /></td></tr>
<tr class="separator:aac0bbb4cddfac921ea84d64f38a280b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d38505908d498ec96c4b71095a5edce"><td class="memItemLeft" align="right" valign="top"><a id="a6d38505908d498ec96c4b71095a5edce" name="a6d38505908d498ec96c4b71095a5edce"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_ftp_credentials</b> ()</td></tr>
<tr class="memdesc:a6d38505908d498ec96c4b71095a5edce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the ftp server credentials based on the configuration file If a username was provided, a password will be requested for that user If not provided, the credentials of the user running the program will be used, so the execution must be with root permissions. Upon completion, root permissions are removed for security purposes. <br /></td></tr>
<tr class="separator:a6d38505908d498ec96c4b71095a5edce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe14db02275752a44c32d0641a7e2050"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#abe14db02275752a44c32d0641a7e2050">ftp_session_loop</a> (void *args)</td></tr>
<tr class="memdesc:abe14db02275752a44c32d0641a7e2050"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main loop for reception of FTP commands.  <a href="ftps__server_8c.html#abe14db02275752a44c32d0641a7e2050">More...</a><br /></td></tr>
<tr class="separator:abe14db02275752a44c32d0641a7e2050"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58dbe7499fb306c0ec6446ee82dded26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#a58dbe7499fb306c0ec6446ee82dded26">set_end_flag</a> (int sig)</td></tr>
<tr class="memdesc:a58dbe7499fb306c0ec6446ee82dded26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activates end of program flag.  <a href="ftps__server_8c.html#a58dbe7499fb306c0ec6446ee82dded26">More...</a><br /></td></tr>
<tr class="separator:a58dbe7499fb306c0ec6446ee82dded26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8daaea33fe8d5b2b72e8df193540ee7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#ab8daaea33fe8d5b2b72e8df193540ee7">set_handlers</a> ()</td></tr>
<tr class="memdesc:ab8daaea33fe8d5b2b72e8df193540ee7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add handlers for SIGTERM, SIGINT and SIGPIPE signals.  <a href="ftps__server_8c.html#ab8daaea33fe8d5b2b72e8df193540ee7">More...</a><br /></td></tr>
<tr class="separator:ab8daaea33fe8d5b2b72e8df193540ee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30d335df69a7b3f8ee134ad84f6619b5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#a30d335df69a7b3f8ee134ad84f6619b5">data_callback_loop</a> (<a class="el" href="ftp__session_8h.html#a8257917a84671a3b6a2849210faeeb6b">session_info</a> *session, <a class="el" href="ftp_8h.html#a4693355d7a599645905e5f8de9bb9b91">request_info</a> *ri, <a class="el" href="struct__serverconf.html">serverconf</a> *<a class="el" href="ftps__server_8c.html#aa20bf5c638701e3e4191ffb2756536ca">server_conf</a>, char *buf)</td></tr>
<tr class="memdesc:a30d335df69a7b3f8ee134ad84f6619b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for information from the data connection thread and possible new control requests, of which only abort requests will be accepted.  <a href="ftps__server_8c.html#a30d335df69a7b3f8ee134ad84f6619b5">More...</a><br /></td></tr>
<tr class="separator:a30d335df69a7b3f8ee134ad84f6619b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbf9bf5ec897df1e1597bebdfda9abbb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#afbf9bf5ec897df1e1597bebdfda9abbb">tls_start</a> ()</td></tr>
<tr class="memdesc:afbf9bf5ec897df1e1597bebdfda9abbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load certificate and public key of the server.  <a href="ftps__server_8c.html#afbf9bf5ec897df1e1597bebdfda9abbb">More...</a><br /></td></tr>
<tr class="separator:afbf9bf5ec897df1e1597bebdfda9abbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Application entry point.  <a href="ftps__server_8c.html#a0ddf1224851353fc92bfbff6f499fa97">More...</a><br /></td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa20bf5c638701e3e4191ffb2756536ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct__serverconf.html">serverconf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#aa20bf5c638701e3e4191ffb2756536ca">server_conf</a></td></tr>
<tr class="separator:aa20bf5c638701e3e4191ffb2756536ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a727e6e16e4469189ad4c44be16e5853b"><td class="memItemLeft" align="right" valign="top">sem_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#a727e6e16e4469189ad4c44be16e5853b">n_clients</a></td></tr>
<tr class="separator:a727e6e16e4469189ad4c44be16e5853b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abce9f5dc9c83f2639b72024fdee5d388"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftps__server_8c.html#abce9f5dc9c83f2639b72024fdee5d388">end</a> = 0</td></tr>
<tr class="separator:abce9f5dc9c83f2639b72024fdee5d388"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >FTP server implementation. </p>
<dl class="section author"><dt>Author</dt><dd>Joaquín Jiménez López de Castro (<a href="#" onclick="location.href='mai'+'lto:'+'joa'+'qu'+'in.'+'ji'+'men'+'ez'+'l@e'+'st'+'udi'+'an'+'te.'+'ua'+'m.e'+'s'; return false;">joaqu<span class="obfuscator">.nosp@m.</span>in.j<span class="obfuscator">.nosp@m.</span>imene<span class="obfuscator">.nosp@m.</span>zl@e<span class="obfuscator">.nosp@m.</span>studi<span class="obfuscator">.nosp@m.</span>ante<span class="obfuscator">.nosp@m.</span>.uam.<span class="obfuscator">.nosp@m.</span>es</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>07-04-2020 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a8fb447618db946a9e2a596d9ea18763f" name="a8fb447618db946a9e2a596d9ea18763f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fb447618db946a9e2a596d9ea18763f">&#9670;&#160;</a></span>_DEFAULT_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _DEFAULT_SOURCE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Access to GNU functions </p>

</div>
</div>
<a id="a3024ccd4a9af5109d24e6c57565d74a1" name="a3024ccd4a9af5109d24e6c57565d74a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3024ccd4a9af5109d24e6c57565d74a1">&#9670;&#160;</a></span>_POSIX_C_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _POSIX_C_SOURCE&#160;&#160;&#160;200112L</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Access to POSIX functions </p>

</div>
</div>
<a id="a89e390b657d2bd9a1b4d102ed78ce239" name="a89e390b657d2bd9a1b4d102ed78ce239"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89e390b657d2bd9a1b4d102ed78ce239">&#9670;&#160;</a></span>CONTROL_SOCKET_TIMEOUT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_SOCKET_TIMEOUT&#160;&#160;&#160;150</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Maximum timeout of control connection </p>

</div>
</div>
<a id="ac39f75a2a532f10f6fb237e96c530dcb" name="ac39f75a2a532f10f6fb237e96c530dcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac39f75a2a532f10f6fb237e96c530dcb">&#9670;&#160;</a></span>MAX_PASSWORD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_PASSWORD&#160;&#160;&#160;<a class="el" href="utils_8h.html#ac0cd46269606fb8df1dd1722eb05ecdf">MEDIUM_SZ</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Maximum password size </p>

</div>
</div>
<a id="a1e609267dbe6e0905f6b6279386b5c4d" name="a1e609267dbe6e0905f6b6279386b5c4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e609267dbe6e0905f6b6279386b5c4d">&#9670;&#160;</a></span>THREAD_CLOSE_WAIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THREAD_CLOSE_WAIT&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Maximum time to wait for a thread to close </p>

</div>
</div>
<a id="a1d980ebde0fb952e696005b5d58228a7" name="a1d980ebde0fb952e696005b5d58228a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d980ebde0fb952e696005b5d58228a7">&#9670;&#160;</a></span>USING_AUTHBIND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USING_AUTHBIND&#160;&#160;&#160;&quot;--using-authbind&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Indicates current execution with authbind </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aac0bbb4cddfac921ea84d64f38a280b2" name="aac0bbb4cddfac921ea84d64f38a280b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac0bbb4cddfac921ea84d64f38a280b2">&#9670;&#160;</a></span>accept_loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void accept_loop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>socket_control_fd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loop of acceptance of new connections. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket_control_fd</td><td>Socket of incoming control connections </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a30d335df69a7b3f8ee134ad84f6619b5" name="a30d335df69a7b3f8ee134ad84f6619b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30d335df69a7b3f8ee134ad84f6619b5">&#9670;&#160;</a></span>data_callback_loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void data_callback_loop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ftp__session_8h.html#a8257917a84671a3b6a2849210faeeb6b">session_info</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ftp_8h.html#a4693355d7a599645905e5f8de9bb9b91">request_info</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__serverconf.html">serverconf</a> *&#160;</td>
          <td class="paramname"><em>server_conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits for information from the data connection thread and possible new control requests, of which only abort requests will be accepted. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Contains session information </td></tr>
    <tr><td class="paramname">server_conf</td><td>Contains port semaphore in passive mode </td></tr>
    <tr><td class="paramname">ri</td><td>It is updated with the responses of the data thread </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer to receive data </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abe14db02275752a44c32d0641a7e2050" name="abe14db02275752a44c32d0641a7e2050"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe14db02275752a44c32d0641a7e2050">&#9670;&#160;</a></span>ftp_session_loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * ftp_session_loop </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main loop for reception of FTP commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">args</td><td>Contains client descriptor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void* </dd></dl>

</div>
</div>
<a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Application entry point. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>Number of arguments </td></tr>
    <tr><td class="paramname">argv</td><td>The special argument USING_AUTHBIND is used to indicate that the execution is performed with authbind </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int success if 0 </dd></dl>

</div>
</div>
<a id="a58dbe7499fb306c0ec6446ee82dded26" name="a58dbe7499fb306c0ec6446ee82dded26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58dbe7499fb306c0ec6446ee82dded26">&#9670;&#160;</a></span>set_end_flag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_end_flag </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Activates end of program flag. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sig</td><td>Signal received </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab8daaea33fe8d5b2b72e8df193540ee7" name="ab8daaea33fe8d5b2b72e8df193540ee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8daaea33fe8d5b2b72e8df193540ee7">&#9670;&#160;</a></span>set_handlers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_handlers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add handlers for SIGTERM, SIGINT and SIGPIPE signals. </p>

</div>
</div>
<a id="afbf9bf5ec897df1e1597bebdfda9abbb" name="afbf9bf5ec897df1e1597bebdfda9abbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbf9bf5ec897df1e1597bebdfda9abbb">&#9670;&#160;</a></span>tls_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load certificate and public key of the server. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="abce9f5dc9c83f2639b72024fdee5d388" name="abce9f5dc9c83f2639b72024fdee5d388"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abce9f5dc9c83f2639b72024fdee5d388">&#9670;&#160;</a></span>end</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int end = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Indicates that the program must be terminated </p>

</div>
</div>
<a id="a727e6e16e4469189ad4c44be16e5853b" name="a727e6e16e4469189ad4c44be16e5853b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a727e6e16e4469189ad4c44be16e5853b">&#9670;&#160;</a></span>n_clients</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sem_t n_clients</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Controls that the number of FTP sessions is not exceeded </p>

</div>
</div>
<a id="aa20bf5c638701e3e4191ffb2756536ca" name="aa20bf5c638701e3e4191ffb2756536ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa20bf5c638701e3e4191ffb2756536ca">&#9670;&#160;</a></span>server_conf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__serverconf.html">serverconf</a> server_conf</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Global server configuration </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
